很高兴你决定采用**“冻结+预热”**的训练策略（Option 3）。这是一个非常稳健、工程实现最可控，且最容易在论文里把故事讲圆的方案。

既然核心算法（MoE + dPL + Warm-up）已经定下来了，接下来的重头戏就是**设计实验（Experimental Design）**。

在 Chapter 4 中，你要证明的核心论点是：**“基于数据驱动的动态结构优选（MoE），优于单一固定结构，也优于传统的静态多模型组合。”**

为了支撑这个论点，你需要设计以下 **3 组关键对比实验（Baselines & Ablations）**。这不仅是凑工作量，而是为了回答审稿人一定会问的三个逻辑漏洞。

---

### 第一组：证明“组合”优于“单打独斗” (The Necessity of Ensemble)

这是最基础的及格线，证明你搞这一套复杂的 MoE 是有意义的。

* **对比对象 1：单一物理模型 (Single Best Model)**
* **设置：** 分别单独运行 HBV, ExpHydro, SHM, Hymod（以及它们的变体），取其中 NSE 最高的那一个作为 Benchmark。
* **你的 MoE：** 应该是 。
* **论文逻辑：** “单一模型结构受限于其物理假设（如蓄满产流 vs 超渗产流），无法适应所有水文情景。而 MoE 能博采众长。”


* **对比对象 2：算术平均组合 (Simple Averaging Ensemble)**
* **设置：** 。这是传统水文最常用的多模型集合方法（BMA 的简化版）。
* **你的 MoE：** 应该是 。
* **论文逻辑：** “简单的平均虽然降低了方差，但它同等地对待了‘差模型’和‘好模型’，甚至掩盖了专家的特长。MoE 则实现了‘择优’。”



---

### 第二组：证明“动态”优于“静态” (The Necessity of Dynamic Gating)

**这是你 Chapter 4 最核心的实验，是真正的科学贡献所在。** 审稿人会问：“dPL 算出了一组权重，那为什么这组权重必须是随时间变化的？是不是给 HBV 0.8，给 Hymod 0.2，一直不变也行？”

* **对比对象 3：静态可学习加权 (Static Learnable Weighting)**
* **设置：** 去掉 Gating Network 的输入特征（或者把 Gate 换成一个单纯的可训练向量 ）。
* **公式：** ，其中  是**全局固定**的参数（比如训练出来一直是 HBV=0.6, Hymod=0.4）。
* **你的 MoE：** (Dynamic)  随  变化。
* **预期结果：** Dynamic MoE 的精度应显著高于 Static Weighting。
* **图表画法（关键）：** 你要画一张图，横轴是时间，纵轴是权重。
* Static 是一条死板的直线。
* Dynamic 是一条随降雨波动的曲线。


* **论文逻辑：** **“水文过程具有时变性（Time-varying characteristics）。单一固定的模型结构组合无法同时捕捉枯水期和洪水期的特征，只有动态门控才能实现真正的过程自适应。”**



---

### 第三组：证明“优选”优于“全选” (The Necessity of Structure Search/Sparsity)

这一组是为了呼应你论文标题中的 **“结构搜索 (Structure Search)”** 和 **“优选”**。如果没有这一组，你做的只是“融合（Fusion）”，而不是“搜索（Search）”。

* **对比对象 4：稠密 MoE vs. 稀疏 MoE (Dense vs. Sparse/Top-K)**
* **设置 A (Dense):** 所有 16 个模型都参与计算，权重可能有大有小，但都不为 0。
* **设置 B (Sparse/Top-K):** 在 Gating 输出后加一个操作，只保留权重最大的 Top-3，其余强制归零（或者通过熵正则化逼迫权重极化）。
* **预期结果：**
* 精度上：Sparse 可能和 Dense 差不多，甚至略好（因为去掉了噪声）。
* **计算效率/可解释性：** Sparse 显然更好。


* **论文逻辑：** “通过稀疏化约束，dPL 成功从 16 个候选结构中**剔除**了冗余结构，**搜索**出了最适合该流域的 3 个核心结构。这验证了 dPL 作为架构搜索工具的有效性。”



---

### 💡 实验规划总结表 (可以直接放到论文里)

建议你在论文中列这样一个表，清晰明了：

| 实验编号 | 模型架构名称 | 权重机制 | 物理模型参与数 | 科学目的 |
| --- | --- | --- | --- | --- |
| **Exp 0** | **Single Best** | 无 | 1 (Best) | 确立性能下限 (Baseline) |
| **Exp 1** | **Simple Average** | 固定 () | 16 (All) | 验证加权融合的必要性 |
| **Exp 2** | **Static dPL** | 固定 (可学习) | 16 (All) | **验证动态门控(Dynamic)的必要性** (核心) |
| **Exp 3** | **Dynamic MoE** | **时变 (Gating)** | 16 (All) | **本章提出的主模型** |
| **Exp 4** | **Sparse MoE** | 时变 + Top-K | 3~5 (Selected) | 验证结构搜索与剪枝能力 |

### 📊 还需要画什么图？

除了 NSE/KGE 表格，这一章的 **Visual Analysis (可视化分析)** 比数字更重要：

1. **Gating Weight Time Series (门控权重时序图):**
*
* 展示权重随时间的变化。例如：背景是降雨柱状图，前景是堆叠面积图。你可以指着图说：“看，大雨来的时候，Hymod 的面积突然变大了，说明 dPL 自动切换到了快流机制。”


2. **Regime Analysis (水文情势分析图):**
* 横轴是“土壤湿度”或“降雨强度”，纵轴是“各模型的平均权重”。
* 这能证明 dPL 学到了物理规律（例如：土壤越湿，某个非线性产流模型的权重越高）。



**导师点评：**
先做 Exp 0, 1, 2, 3。Exp 4 (稀疏化) 可以作为锦上添花。
尤其是 **Exp 2 (Static dPL)**，这是审稿人最喜欢挑战的点（“你搞这么花哨的动态权重，真的比算一个固定权重好吗？”），你必须用数据把他的嘴堵上。

准备好开始跑这几个对比了吗？